
<!doctype html>
<html lang="es">
<head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><title>Admin · Seven de Burgers</title><link rel="stylesheet" href="../assets/styles.css"></head>
<body>
  <div class="header"><div class="logo">🍔 Seven de Burgers <span class="badge">Admin</span></div><div class="row"><a class="btn secondary" href="../login/index.html">Login</a></div></div>
  <div class="container">
    <div class="card">
      <div class="kicker">Ventas (Entregadas)</div>
      <table class="table" id="tbl"><thead><tr><th>Fecha</th><th>Cliente</th><th>Producto</th><th>Cant</th><th>Total</th></tr></thead><tbody></tbody></table>
      <div class="row" style="justify-content:flex-end;margin-top:10px"><div>Total ingresos: <span class="price" id="lblTotal">$0</span></div></div>
    </div>
  </div>
  <script type="module">
    import {subscribeOrders, Status} from '../shared/state.smart.js';
    import {ADEREZOS, EXTRAS} from '../shared/menu.js';
    function pAd(id){ return ADEREZOS.find(a=>a.id===id)?.price||0; } function pEx(id){ return EXTRAS.find(e=>e.id===id)?.price||0; }
    function calcTotal(o){ const ad=(o.aderezos||[]).reduce((s,id)=>s+pAd(id),0); const ex=(o.extras||[]).reduce((s,id)=>s+pEx(id),0); return (o.priceUnit+ad+ex)*(o.qty||1); }
    const tbody=document.querySelector('#tbl tbody'); const lbl=document.getElementById('lblTotal');
    subscribeOrders((orders)=>{
      const done=orders.filter(o=>o.status===Status.DELIVERED);
      tbody.innerHTML = done.map(o=>`<tr><td>${new Date(o.updatedAt||o.createdAt).toLocaleString()}</td><td>${o.customer||'-'}</td><td>${o.burgerName||'-'}</td><td>${o.qty||1}</td><td>$${calcTotal(o)}</td></tr>`).join('');
      lbl.textContent='$'+done.reduce((s,o)=>s+calcTotal(o),0);
    });
  </script>
  <footer>Backend: <span id="bk">—</span></footer>
  <script type="module">import {backendName} from '../shared/state.smart.js'; document.getElementById('bk').textContent=backendName;</script>
</body></html>

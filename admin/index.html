<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <link rel="stylesheet" href="../shared/styles.css"/>
  <title>Admin — Seven de Burgers</title>
  <style>
    .tabs-admin{ display:flex; gap:8px; flex-wrap:wrap; margin-bottom:12px; }
    .tabs-admin .tab{ padding:10px 12px; border-radius:12px; border:2px solid #2a3347; background:#121a2a; color:#eaf2ff; cursor:pointer; }
    .tabs-admin .tab.is-active{ border-color:#ffd24a; box-shadow:0 0 0 2px rgba(255,210,74,.15) inset; }
    .panel{ display:none; }
    .panel.active{ display:block; }
    .k-table{ width:100%; border-collapse:collapse; font-size:14px }
    .k-table th,.k-table td{ padding:10px; border-bottom:1px solid rgba(255,255,255,.08) }
    .k-table th{ text-align:left; color:var(--muted) }
    .k-badge.ok{ background:#183a2a }
    .k-badge.warn{ background:#3a2f18 }

    /* Recetario */
    .rc-grid{ display:grid; grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); gap:12px; }
    .rc-ingredients{ max-height:340px; overflow:auto; border:1px solid rgba(255,255,255,.08); border-radius:10px; padding:8px; }
    .muted.sm{ font-size:12px; color:var(--muted); }
  </style>
</head>
<body>
<header class="header">
  <div class="brand"><span class="dot"></span>
    <div><div>Seven de Burgers</div><div class="title-sub">Admin</div></div>
  </div>
  <nav class="row" style="gap:8px">
    <a class="btn ghost small" href="../kiosk/">Kiosko</a>
    <a class="btn ghost small" href="../cocina/">Cocina</a>
    <a class="btn ghost small" href="../mesero/">Mesero</a>
  </nav>
</header>

<main class="container">
  <div class="card">
    <h2>Panel de administración</h2>
    <div class="tabs-admin" id="admTabs" role="tablist" aria-label="Módulos de Admin">
      <button class="tab is-active" data-tab="reportes" role="tab" aria-selected="true">Reportes</button>
      <button class="tab" data-tab="compras" role="tab" aria-selected="false">Compras</button>
      <button class="tab" data-tab="inventario" role="tab" aria-selected="false">Inventario</button>
      <button class="tab" data-tab="proveedores" role="tab" aria-selected="false">Proveedores</button>
      <button class="tab" data-tab="productos" role="tab" aria-selected="false">Productos / Combos</button>
      <button class="tab" data-tab="happy" role="tab" aria-selected="false">Happy Hour</button>
      <button class="tab" data-tab="recetas" role="tab" aria-selected="false">Recetario</button>
    </div>

    <!-- REPORTES -->
    <section class="panel active" id="panel-reportes">
      <h3>Reportes de ventas</h3>
      <div class="grid" style="grid-template-columns:repeat(auto-fit,minmax(260px,1fr))">
        <div class="field"><label>Desde</label><input id="repFrom" type="date"/></div>
        <div class="field"><label>Hasta</label><input id="repTo" type="date"/></div>
        <div class="field"><label>Tipo de pedido</label>
          <select id="repType"><option value="all">Todos</option><option value="pickup">Pickup</option><option value="dinein">Mesa</option></select>
        </div>
        <div class="field"><label>Incluir archivo histórico</label>
          <select id="repHist"><option>Sí</option><option>No</option></select>
        </div>
        <div class="field" style="align-self:end"><button class="btn" id="btnRepGen">Generar</button></div>
      </div>

      <div class="grid" style="margin-top:10px; grid-template-columns:repeat(auto-fit,minmax(220px,1fr))">
        <div class="k-card"><div class="muted small">Órdenes</div><div id="kpiOrders" class="price">$0</div></div>
        <div class="k-card"><div class="muted small">Artículos vendidos</div><div id="kpiUnits" class="price">$0</div></div>
        <div class="k-card"><div class="muted small">Ingresos</div><div id="kpiRevenue" class="price">$0</div></div>
        <div class="k-card"><div class="muted small">Ticket promedio</div><div id="kpiAvg" class="price">$0</div></div>
      </div>

      <h4 style="margin-top:16px">Top productos</h4>
      <table class="k-table" id="tblTop"><thead><tr><th>Producto</th><th>Unidades</th><th>Ingresos</th></tr></thead><tbody></tbody></table>

      <h4 style="margin-top:16px">Productos de baja rotación</h4>
      <table class="k-table" id="tblLow"><thead><tr><th>Producto</th><th>Unidades</th><th>Ingresos</th></tr></thead><tbody></tbody></table>

      <h4 style="margin-top:16px">Ventas por hora</h4>
      <table class="k-table" id="tblHours"><thead><tr><th>Hora</th><th>Órdenes</th><th>Ingresos</th></tr></thead><tbody></tbody></table>
    </section>

    <!-- COMPRAS -->
    <section class="panel" id="panel-compras">
      <h3>Compras</h3>
      <div class="grid" style="grid-template-columns:repeat(auto-fit,minmax(260px,1fr))">
        <div class="field"><label>Ingrediente</label><input id="pName" type="text"></div>
        <div class="field"><label>Cantidad comprada (unid/kg/l)</label><input id="pQty" type="number" min="0" step="0.01"></div>
        <div class="field"><label>Costo total</label><input id="pCost" type="number" min="0" step="0.01"></div>
        <div class="field"><label>Proveedor (opcional)</label><input id="pVendor" type="text" placeholder="id proveedor o nombre"></div>
        <div class="field" style="align-self:end"><button class="btn" id="btnAddPurchase">Registrar compra</button></div>
      </div>
      <div class="muted small">* Guarda en <b>purchases</b> y actualiza <b>inventory</b> con costo promedio.</div>

      <h4 style="margin-top:16px">Últimas compras</h4>
      <table class="k-table" id="tblPurch"><thead><tr><th>Fecha</th><th>Ingrediente</th><th>Cant.</th><th>Costo</th><th>Proveedor</th></tr></thead><tbody></tbody></table>
    </section>

    <!-- INVENTARIO -->
    <section class="panel" id="panel-inventario">
      <h3>Inventario</h3>
      <div class="grid" style="grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); margin-bottom:6px">
        <div class="field"><label>Buscar</label><input id="invSearch" type="text" placeholder="nombre…"></div>
        <div class="field" style="align-self:end"><button class="btn ghost" id="btnInvRefresh">Actualizar</button></div>
      </div>
      <table class="k-table" id="tblInv"><thead><tr><th>Ingrediente</th><th>Existencia</th><th>Um</th><th>Costo prom.</th><th>Valorizado</th></tr></thead><tbody></tbody></table>
    </section>

    <!-- PROVEEDORES -->
    <section class="panel" id="panel-proveedores">
      <h3>Proveedores</h3>
      <div class="grid" style="grid-template-columns:repeat(auto-fit,minmax(260px,1fr))">
        <div class="field"><label>Nombre</label><input id="vName" type="text"></div>
        <div class="field"><label>Contacto</label><input id="vContact" type="text" placeholder="tel / mail / nota"></div>
        <div class="field" style="align-self:end"><button class="btn" id="btnSaveVendor">Guardar</button></div>
      </div>
      <table class="k-table" id="tblVendors"><thead><tr><th>Nombre</th><th>Contacto</th><th>ID</th></tr></thead><tbody></tbody></table>
    </section>

    <!-- PRODUCTOS / COMBOS -->
    <section class="panel" id="panel-productos">
      <h3>Productos / Combos</h3>
      <div class="muted">WIP — Aquí podrás crear/editar productos, fijar precios y armar combos. El kiosko lee directo de <b>products</b>.</div>
      <div class="field" style="margin-top:10px"><button class="btn ghost" id="btnReloadCatalog">Refrescar catálogo del kiosko</button></div>
      <table class="k-table" id="tblProducts"><thead><tr><th>Nombre</th><th>Tipo</th><th>Precio</th><th>Activo</th><th>ID</th></tr></thead><tbody></tbody></table>
    </section>

    <!-- HAPPY HOUR -->
    <section class="panel" id="panel-happy">
      <h3>Happy Hour</h3>
      <div class="grid" style="grid-template-columns:repeat(auto-fit,minmax(260px,1fr))">
        <div class="field"><label>Estado</label>
          <select id="hhEnabled"><option value="off">Desactivada</option><option value="on">Activada</option></select>
        </div>
        <div class="field"><label>Descuento general (%)</label><input id="hhDisc" type="number" min="0" max="90" value="0"></div>
        <div class="field"><label>Mensaje en kiosko</label><input id="hhMsg" type="text" placeholder="Ej. 2x1 en Minis 7–8 pm"></div>
        <div class="field" style="align-self:end"><button class="btn" id="btnSaveHappy">Guardar HH</button></div>
      </div>
      <div class="muted small">* Guarda en <b>settings/happyHour</b>. El kiosko lo muestra y aplica el descuento si corresponde.</div>
      <h4 style="margin-top:16px">Reglas específicas</h4>
      <div class="muted small">WIP — podrás seleccionar productos/combos con descuento exclusivo durante HH.</div>
    </section>

    <!-- RECETARIO -->
    <section class="panel" id="panel-recetas">
      <h3>Recetario de aderezos</h3>
      <div class="rc-grid">
        <div class="field">
          <label>Receta</label>
          <select id="rcRecipe"></select>
          <div class="muted sm">* Las recetas vienen de la colección <b>recipes</b>.</div>
        </div>
        <div class="field">
          <label>Porción</label>
          <div class="row" style="gap:6px; flex-wrap:wrap">
            <button class="btn ghost small" data-portion="100">100 ml</button>
            <button class="btn ghost small" data-portion="200">200 ml</button>
            <button class="btn ghost small" data-portion="500">500 ml</button>
            <input id="rcCustom" type="number" min="1" step="1" placeholder="ml (custom)" style="width:140px">
            <button class="btn small" id="rcApply">Aplicar</button>
          </div>
        </div>
        <div class="field">
          <label>Salida (ml)</label>
          <input id="rcOut" type="number" min="1" step="1" value="100">
          <div class="muted sm">Rinde del lote a preparar.</div>
        </div>
      </div>

      <div class="grid" style="grid-template-columns:1fr 1fr; gap:12px; margin-top:12px">
        <div>
          <h4>Ingredientes escalados</h4>
          <div class="rc-ingredients">
            <table class="k-table" id="rcIngr"><thead><tr><th>Ingrediente</th><th>Cant.</th><th>UM</th></tr></thead><tbody></tbody></table>
          </div>
        </div>
        <div>
          <h4>Producción</h4>
          <div class="grid" style="grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:10px">
            <div class="field">
              <label>Producto terminado (inventario)</label>
              <input id="rcOutputName" type="text" disabled>
              <div class="muted sm">ID: <span id="rcOutputId">—</span></div>
            </div>
            <div class="field">
              <label>Envasado en vaso 2oz (opcional)</label>
              <div class="row" style="gap:8px">
                <input id="rcCupCount" type="number" min="0" step="1" value="0" style="width:120px">
                <span class="muted sm">* Descuenta vasitos del inventario si está configurado.</span>
              </div>
            </div>
            <div class="field">
              <label>Guardar para almacenamiento</label>
              <div class="row" style="gap:8px">
                <select id="rcStore"><option value="no">No</option><option value="si">Sí</option></select>
                <input id="rcStoreQty" type="number" min="0" step="1" value="0" style="width:120px">
              </div>
              <div class="muted sm">Si es “Sí”, guarda meta con cantidad almacenada (ml).</div>
            </div>
            <div class="field" style="align-self:end">
              <button class="btn" id="rcMake">Preparar lote</button>
            </div>
          </div>
          <div class="muted sm" style="margin-top:6px">
            Al preparar: descuenta ingredientes, abona salida en inventario, registra fecha/hora; si indicas vasos 2oz, descuenta vasitos; si es para almacenar, registra la cantidad.
          </div>
        </div>
      </div>
    </section>

  </div>
</main>

<script type="module" src="./app.js"></script>
</body>
</html>

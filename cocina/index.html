<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport"
        content="width=device-width, initial-scale=1, viewport-fit=cover, interactive-widget=resizes-content"/>
  <meta name="theme-color" content="#0b1220"/>
  <title>Cocina ‚Äî Seven de Burgers</title>
  <link rel="icon" href="../favicon.ico">
  <link rel="stylesheet" href="../shared/styles.css">

  <style>
    :root{ --vh: 1vh; }

    /* üîí NO dejes que el body scrollee (Safari cambia su alto y ‚Äúsalta‚Äù) */
    body.shell.fixed-root{
      position: fixed;
      inset: 0;
      overflow: hidden;
      touch-action: manipulation;
      -webkit-overflow-scrolling: auto;
      background: var(--bg, #0b1220);
    }

    /* Contenedor principal ocupa 100% del alto visible real */
    .container#appRoot{
      height: calc(var(--vh) * 100);
      display: flex;
      flex-direction: column;
      overflow: hidden; /* nada de scroll aqu√≠ */
    }

    /* Grid de columnas con scrollers internos */
    .k-columns{
      flex: 1;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      min-height: 0;    /* clave para que los hijos puedan scrollear */
      contain: layout;
    }
    @media (max-width: 900px){
      .k-columns{ grid-template-columns: 1fr; }
    }

    .k-columns .card{
      display: flex;
      flex-direction: column;
      min-height: 0;    /* permite que .col calcule altura */
      contain: content;
    }

    .k-columns .col{
      flex: 1;
      overflow: auto;                   /* üîë aqu√≠ s√≠ hay scroll */
      -webkit-overflow-scrolling: touch;
      overscroll-behavior: contain;     /* no ‚Äútira‚Äù el scroll al body */
      overflow-anchor: none;            /* evita anclajes autom√°ticos */
      min-height: 0;
      contain: layout paint;
    }

    /* Evita scroll suave que acent√∫a el efecto */
    html, body, .k-columns .col{ scroll-behavior: auto !important; }
  </style>

  <script>
    // Altura de viewport real para m√≥viles (evita saltos al aparecer la barra)
    function setVH(){
      const h = (window.visualViewport?.height || window.innerHeight) * 0.01;
      document.documentElement.style.setProperty('--vh', h + 'px');
    }
    setVH();
    window.addEventListener('resize', setVH, { passive:true });
    window.addEventListener('orientationchange', setVH, { passive:true });
  </script>
</head>

<body class="shell fixed-root">
  <div class="container" role="main" id="appRoot">
    <div class="row" style="margin-bottom:10px">
      <a class="badge" href="../kiosk/">Kiosko</a>
      <div class="right badge" aria-current="page">Cocina</div>
    </div>

    <div id="live-region" class="visually-hidden" aria-live="polite" aria-atomic="true"></div>

    <div class="k-columns">
      <div class="card">
        <h2>Pendientes</h2>
        <div id="col-pending" class="col" aria-label="√ìrdenes pendientes"></div>
      </div>
      <div class="card">
        <h2>En preparaci√≥n</h2>
        <div id="col-progress" class="col" aria-label="√ìrdenes en preparaci√≥n"></div>
      </div>
      <div class="card">
        <h2>Listos</h2>
        <div id="col-ready" class="col" aria-label="√ìrdenes listas para entregar"></div>
      </div>
      <div class="card">
        <h2>Por cobrar</h2>
        <div id="col-bill" class="col" aria-label="√ìrdenes por cobrar"></div>
      </div>
    </div>
  </div>

  <!-- ====== RUTA MODERNA (ESM) ====== -->
  <script type="module" src="./app.js"></script>

  <!-- ====== LEGACY (sin m√≥dulos) ====== -->
  <script nomodule src="https://cdn.jsdelivr.net/npm/promise-polyfill@8/dist/polyfill.min.js"></script>
  <script nomodule src="https://cdn.jsdelivr.net/npm/whatwg-fetch@3/dist/fetch.umd.js"></script>
  <script nomodule>
    (function(){ if(!window.console){window.console={};['log','warn','error','info'].forEach(function(m){console[m]=function(){}});} })();
    if (!Element.prototype.closest) {
      Element.prototype.closest = function(s) {
        var el = this; if(!document.documentElement.contains(el)) return null;
        do { if(el.matches && el.matches(s)) return el; el = el.parentElement || el.parentNode; } while (el && el.nodeType === 1);
        return null;
      };
    }
    if (window.NodeList && !NodeList.prototype.forEach) NodeList.prototype.forEach = Array.prototype.forEach;
    if (!Object.assign) Object.assign = function(t){ for(var i=1;i<arguments.length;i++){ var s=arguments[i]||{}; for(var k in s){ if(Object.prototype.hasOwnProperty.call(s,k)) t[k]=s[k]; } } return t; };
    if (!String.prototype.includes) String.prototype.includes = function(s, i){ return this.indexOf(s, i||0) !== -1; };
  </script>

  <script nomodule src="../shared/compat.js"></script>
  <script nomodule src="../shared/notify.legacy.js"></script>
  <script nomodule src="../shared/db.legacy.js"></script>
  <script nomodule src="./app.legacy.js"></script>
</body>
</html>

<!doctype html>

<html lang="es" data-theme="retro">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="format-detection" content="telephone=no" />
  <meta name="theme-color" content="#0b1220" />
  <title>Seven ‚Äî Kiosko Lite (DEMO)</title>
  <style>
    :root{
      --bg:#0b1220; --panel:#101a2d; --card:#0f182a; --txt:#e8f0ff; --muted:#a6b2c7;
      --primary:#ff2e88; --primary-2:#ffd400; --accent:#00e0ff; --ok:#20e070; --warn:#ff9c2e;
      --chip:#192840; --border:#2a3b5e; --danger:#ff4d4d;
      --px: clamp(12px, 2.2vw, 16px);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--txt);font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;}
    .wrap{max-width:980px;margin:0 auto;padding:12px}
    header{position:sticky;top:0;z-index:10;background:linear-gradient(180deg, rgba(11,18,32,.95) 60%, rgba(11,18,32,0));backdrop-filter:saturate(1.2) blur(6px);padding:10px 12px;border-bottom:1px solid var(--border)}
    .brand{display:flex;align-items:center;gap:10px}
    .brand .logo{width:28px;height:28px;border-radius:6px;background:linear-gradient(135deg,var(--primary),var(--primary-2));display:grid;place-items:center;font-weight:900;color:#0b1220}
    .brand h1{font-size:16px;margin:0;letter-spacing:.5px}
    .badge{padding:3px 8px;border:1px dashed var(--primary);color:var(--primary);border-radius:999px;font-size:12px}
    .grid{display:grid;grid-template-columns: 1fr 360px; gap:10px}
    @media (max-width:900px){ .grid{ grid-template-columns:1fr } }
    .card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:10px}
    .card h2{margin:0 0 8px 0;font-size:16px}
    .products{display:grid;grid-template-columns: repeat(2, minmax(0,1fr)); gap:10px}
    @media (max-width:640px){ .products{ grid-template-columns:1fr } }
    .p{display:grid;grid-template-columns: 86px 1fr; gap:10px; align-items:center;background:linear-gradient(180deg,#0f192c,#0b1324);border:1px solid var(--border);border-radius:12px;overflow:hidden}
    .p .img{width:86px;height:86px;background:#0b1220;display:grid;place-items:center;font-size:22px}
    .p .meta{padding:6px 6px 6px 0}
    .p .meta h3{margin:0;font-size:14px}
    .p .meta p{margin:2px 0 0 0;color:var(--muted);font-size:12px}
    .row{display:flex;align-items:center;justify-content:space-between;gap:10px}
    button{appearance:none;border:1px solid var(--border);background:var(--chip);color:var(--txt);padding:10px 12px;border-radius:12px;font-weight:700}
    button.primary{background:linear-gradient(135deg,var(--primary),var(--primary-2));border:none;color:#0b1220}
    button.ghost{background:transparent;border-color:var(--border)}
    button.danger{background:linear-gradient(135deg,#ff5a5a,#ff9a9a);border:none;color:#2b0a0a}
    .cart{position:sticky; top:64px}
    .cart .line{display:grid;grid-template-columns: 1fr auto auto; gap:8px; align-items:center;margin-bottom:8px}
    .qty{display:flex;align-items:center;gap:6px}
    .qty button{width:28px;height:28px;padding:0}
    .total{font-size:18px;font-weight:900}
    .muted{color:var(--muted)}
    .chip{display:inline-flex;align-items:center;gap:6px;background:var(--chip);border:1px solid var(--border);padding:6px 8px;border-radius:999px;font-size:12px}
    .panel{display:grid;gap:8px}
    input, select{width:100%;padding:10px 12px;border-radius:12px;border:1px solid var(--border);background:#0e182b;color:var(--txt)}
    .foot{display:flex;flex-wrap:wrap;gap:8px;align-items:center;justify-content:space-between;margin-top:8px}
    .note{font-size:12px;color:var(--muted)}
    .toast{position:fixed;left:50%;bottom:16px;transform:translateX(-50%);background:#111b2f;border:1px solid var(--border);padding:10px 12px;border-radius:12px;opacity:0;pointer-events:none;transition:opacity .2s, transform .2s}
    .toast.show{opacity:1;transform:translateX(-50%) translateY(-6px)}
    .floating{position:fixed;right:10px;bottom:10px;display:flex;flex-direction:column;gap:8px}
    .floating button{font-size:12px;padding:6px 10px}
    .hh{display:flex;flex-wrap:wrap;gap:6px;align-items:center}
    .divider{height:1px;background:linear-gradient(90deg,transparent,var(--border),transparent);margin:6px 0}
    .kiosk-title{font-weight:900;letter-spacing:1px}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
  </style>
</head>
<body>
  <header>
    <div class="wrap row">
      <div class="brand">
        <div class="logo">7</div>
        <h1 class="kiosk-title">Seven de Burgers ¬∑ Kiosko Lite</h1>
        <span id="trainingBadge" class="badge" aria-live="polite">MODO DEMO</span>
      </div>
      <div class="hh" id="hhStrip" aria-live="polite"></div>
    </div>
  </header>  <main class="wrap grid" id="app" aria-busy="true">
    <section class="card">
      <h2>Player Select</h2>
      <div class=\"products\" id=\"productList\" role=\"list\">
          <!-- Fallback HTML est√°tico por si JS tarda en iniciar -->
          <div class=\"p\" role=\"listitem\"> 
            <div class=\"img\">üçî</div>
            <div class=\"meta\">
              <div class=\"row\"><h3>Starter Burger</h3><strong>$47</strong></div>
              <p class=\"muted\">Carne 85g, quesos, lechuga, jitomate, cebolla.</p>
              <div class=\"row\" style=\"margin-top:6px\"><button data-add=\"starter\">Agregar</button><button class=\"ghost\" data-less=\"starter\">Quitar</button></div>
            </div>
          </div>
          <div class=\"p\" role=\"listitem\"> 
            <div class=\"img\">üçç</div>
            <div class=\"meta\">
              <div class=\"row\"><h3>Koopa Crunch</h3><strong>$57</strong></div>
              <p class=\"muted\">Queso blanco, pi√±a, tocino. Sugerido: Chimichurri.</p>
              <div class=\"row\" style=\"margin-top:6px\"><button data-add=\"koopa\">Agregar</button><button class=\"ghost\" data-less=\"koopa\">Quitar</button></div>
            </div>
          </div>
          <div class=\"p\" role=\"listitem\"> 
            <div class=\"img\">üßÄ</div>
            <div class=\"meta\">
              <div class=\"row\"><h3>Mega Byte</h3><strong>$77</strong></div>
              <p class=\"muted\">Cheddar, tocino, salchicha en tiras, cebolla.</p>
              <div class=\"row\" style=\"margin-top:6px\"><button data-add=\"megabyte\">Agregar</button><button class=\"ghost\" data-less=\"megabyte\">Quitar</button></div>
            </div>
          </div>
          <div class=\"p\" role=\"listitem\"> 
            <div class=\"img\">üî•</div>
            <div class=\"meta\">
              <div class=\"row\"><h3>Hadouken</h3><strong>$67</strong></div>
              <p class=\"muted\">Doble queso, chipotle, lechuga, jitomate, cebolla.</p>
              <div class=\"row\" style=\"margin-top:6px\"><button data-add=\"hadouken\">Agregar</button><button class=\"ghost\" data-less=\"hadouken\">Quitar</button></div>
            </div>
          </div>
          <div class=\"p\" role=\"listitem\"> 
            <div class=\"img\">üëë</div>
            <div class=\"meta\">
              <div class=\"row\"><h3>Final Boss</h3><strong>$87</strong></div>
              <p class=\"muted\">La jefa. Tocino + salchicha + quesos.</p>
              <div class=\"row\" style=\"margin-top:6px\"><button data-add=\"finalboss\">Agregar</button><button class=\"ghost\" data-less=\"finalboss\">Quitar</button></div>
            </div>
          </div>
          <div class=\"p\" role=\"listitem\"> 
            <div class=\"img\">üéÆ</div>
            <div class=\"meta\">
              <div class=\"row\"><h3>Combo 3 Minis</h3><strong>$97</strong></div>
              <p class=\"muted\">Tres minis de 45g. Logro: Combo Unlocked.</p>
              <div class=\"row\" style=\"margin-top:6px\"><button data-add=\"mini3\">Agregar</button><button class=\"ghost\" data-less=\"mini3\">Quitar</button></div>
            </div>
          </div>
        </div>
    </section><aside class="card cart" aria-label="Carrito">
  <h2>Tu pedido</h2>
  <div id="cartList"></div>
  <div class="divider"></div>
  <div class="panel">
    <div class="row"><span class="muted">Subtotal</span><span id="subtotal">$0</span></div>
    <div class="row"><span class="muted">Descuento HH</span><span id="hhDiscount">$0</span></div>
    <div class="row total"><span>Total</span><span id="total">$0</span></div>
    <label class="sr-only" for="custName">Nombre</label>
    <input id="custName" placeholder="Tu nombre" autocomplete="name" />
    <div class="row">
      <select id="orderType" aria-label="Tipo de pedido">
        <option value="pickup">Pickup</option>
        <option value="dinein">Mesa</option>
      </select>
      <input id="tableNum" placeholder="# mesa (si aplica)" inputmode="numeric" />
    </div>
    <button id="confirm" class="primary">Confirmar pedido</button>
    <div class="foot">
      <span class="note">Demo local sin conexi√≥n a Firestore.</span>
      <button id="clear" class="ghost">Vaciar</button>
    </div>
  </div>
</aside>

  </main>  <div id="toast" class="toast" role="status" aria-live="polite"></div>  <div class="floating">
    <button id="btnFullscreen">Pantalla completa</button>
    <button id="btnSound">Probar sonido</button>
    <button id="btnToggleHH">HH ON/OFF</button>
    <button id="btnScaleUp">Zoom +</button>
    <button id="btnScaleDown">Zoom ‚àí</button>
  </div>  <audio id="sfx" preload="auto">
    <source src="data:audio/mp3;base64,//uQZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" type="audio/mpeg" />
  </audio>  <script>
  /* =====================================================================
     Kiosko Lite (DEMO) ‚Äî single-file, sin imports. Listo para iPad mini.
     - Cat√°logo m√≠nimo
     - Carrito + HH simulado
     - Confirmaci√≥n de pedido (mock) + ID de demo
     - Botones grandes, sticky cart, PWA-like headers
     ===================================================================== */

  // ======= Utilidades UI breves =======
  const $ = (s, r=document)=> r.querySelector(s);
  const $$ = (s, r=document)=> Array.from(r.querySelectorAll(s));
  const money = n=> `$${n.toFixed(0)}`;
  const toast = (msg)=>{ const el = $('#toast'); el.textContent=msg; el.classList.add('show'); setTimeout(()=>el.classList.remove('show'), 1600); };

  // ======= Cat√°logo demo (precios terminan en 7) =======
  const CATALOG = [
    {id:'starter', name:'Starter Burger', price:47, desc:'Carne 85g, quesos, lechuga, jitomate, cebolla.'},
    {id:'koopa', name:'Koopa Crunch', price:57, desc:'Queso blanco, pi√±a, tocino. Sugerido: Chimichurri.'},
    {id:'megabyte', name:'Mega Byte', price:77, desc:'Cheddar, tocino, salchicha en tiras, cebolla.'},
    {id:'hadouken', name:'Hadouken', price:67, desc:'Doble queso, chipotle, lechuga, jitomate, cebolla.'},
    {id:'finalboss', name:'Final Boss', price:87, desc:'La jefa. Tocino + salchicha + quesos.'},
    {id:'mini3', name:'Combo 3 Minis', price:97, desc:'Tres minis de 45g. Logro: Combo Unlocked.'}
  ];

  // ======= Estado =======
  const state = {
    cart: [],
    hh: { active:true, discountPct:20, endsAt: Date.now()+45*60*1000 }, // demo
    zoom: 1
  };

  // ======= DB shim (demo) =======
  const DB = {
    subscribeHappyHour(cb){ cb({...state.hh}); this._hhCB = cb; },
    toggleHH(){ state.hh.active = !state.hh.active; state.hh.endsAt = Date.now()+30*60*1000; this._hhCB && this._hhCB({...state.hh}); },
    async createOrder(payload){ await new Promise(r=>setTimeout(r, 600)); return { id: `DEMO-${Date.now().toString(36).toUpperCase()}` }; }
  };
  window.DB = DB; // por si quieres probar desde consola

  // ======= Render productos =======
  function renderProducts(){
    const list = $('#productList');
    list.innerHTML = '';
    for (const p of CATALOG){
      const el = document.createElement('div'); el.className = 'p'; el.setAttribute('role','listitem');
      el.innerHTML = `
        <div class="img" aria-hidden="true">üçî</div>
        <div class="meta">
          <div class="row">
            <h3>${p.name}</h3>
            <strong>${money(p.price)}</strong>
          </div>
          <p class="muted">${p.desc}</p>
          <div class="row" style="margin-top:6px">
            <button data-add="${p.id}">Agregar</button>
            <button class="ghost" data-less="${p.id}">Quitar</button>
          </div>
        </div>`;
      list.appendChild(el);
    }
    list.addEventListener('click', (e)=>{
      const add = e.target.closest('[data-add]');
      const less = e.target.closest('[data-less]');
      if(add){ addToCart(add.dataset.add); }
      if(less){ addToCart(less.dataset.less, -1); }
    }, { passive:true });
  }

  // ======= Carrito =======
  function addToCart(id, delta=1){
    const prod = CATALOG.find(p=>p.id===id); if(!prod){ return; }
    const line = state.cart.find(l=>l.id===id);
    if(!line){ state.cart.push({ id, name:prod.name, price:prod.price, qty: Math.max(0, delta>0?1:0) }); }
    else { line.qty = Math.max(0, line.qty + delta); }
    state.cart = state.cart.filter(l=>l.qty>0);
    renderCart();
  }

  function renderCart(){
    const list = $('#cartList'); list.innerHTML='';
    let subtotal=0;
    for(const l of state.cart){
      subtotal += l.price * l.qty;
      const row = document.createElement('div'); row.className='line';
      row.innerHTML = `
        <div>
          <div>${l.name}</div>
          <div class="muted">${money(l.price)} √ó ${l.qty}</div>
        </div>
        <div class="qty">
          <button data-qty="-1" data-id="${l.id}">‚àí</button>
          <span>${l.qty}</span>
          <button data-qty="1" data-id="${l.id}">+</button>
        </div>
        <div><strong>${money(l.price*l.qty)}</strong></div>`;
      list.appendChild(row);
    }
    list.addEventListener('click', (e)=>{
      const btn = e.target.closest('[data-qty]'); if(!btn) return;
      const id = btn.dataset.id; const d = parseInt(btn.dataset.qty,10);
      addToCart(id, d);
    }, { passive:true });

    const hhPct = (state.hh.active? state.hh.discountPct : 0);
    const discount = Math.round(subtotal * hhPct / 100);
    const total = Math.max(0, subtotal - discount);
    $('#subtotal').textContent = money(subtotal);
    $('#hhDiscount').textContent = `‚àí${money(discount)}`;
    $('#total').textContent = money(total);
    $('#app').setAttribute('aria-busy','false');
  }

  // ======= HH strip =======
  function renderHHStrip(hh){
    const el = $('#hhStrip');
    if(!hh.active){ el.innerHTML = '<span class="chip">Happy Hour: apagado</span>'; return; }
    const mins = Math.max(0, Math.ceil((hh.endsAt - Date.now())/60000));
    el.innerHTML = `
      <span class="chip">Happy Hour <strong>${hh.discountPct}%</strong> OFF</span>
      <span class="chip">Termina en ~ ${mins} min</span>`;
  }

  // ======= Confirmar pedido (mock) =======
  async function confirmOrder(){
    const name = ($('#custName').value||'').trim();
    if(!name){ toast('Escribe tu nombre'); return; }
    if(state.cart.length===0){ toast('Agrega algo al carrito'); return; }
    const orderType = $('#orderType').value;
    const table = ($('#orderType').value==='dinein') ? ($('#tableNum').value||'').trim() : '';

    const payload = {
      customerName: name,
      lines: state.cart,
      subtotal: $('#subtotal').textContent,
      discount: $('#hhDiscount').textContent,
      total: $('#total').textContent,
      orderMeta: { type: orderType, table },
      hh: { ...state.hh }
    };
    const btn = $('#confirm'); const prev = btn.textContent; btn.disabled=true; btn.textContent='Enviando‚Ä¶';
    const { id } = await DB.createOrder(payload);
    btn.disabled=false; btn.textContent=prev;
    toast(`Pedido confirmado: ${id}`);
    // Limpia carrito tras confirmar
    state.cart = []; renderCart();
  }

  // ======= Pantalla completa / sonido / zoom =======
  async function goFullscreen(){
    const el = document.documentElement; if(el.requestFullscreen){ try{ await el.requestFullscreen(); }catch{} }
  }
  function playSound(){ const a = $('#sfx'); a.currentTime=0; a.play().catch(()=>toast('Toca la pantalla antes para habilitar audio')); }
  function zoom(dx){ state.zoom = Math.max(.85, Math.min(1.4, state.zoom + dx)); document.body.style.fontSize = `calc(var(--px) * ${state.zoom})`; }

  // ======= Inicializaci√≥n =======
  function init(){
    renderProducts(); renderCart();
    DB.subscribeHappyHour((hh)=>{ state.hh = hh; renderHHStrip(hh); renderCart(); });
    $('#confirm').addEventListener('click', confirmOrder);
    $('#clear').addEventListener('click', ()=>{ state.cart=[]; renderCart(); });
    $('#btnFullscreen').addEventListener('click', goFullscreen);
    $('#btnSound').addEventListener('click', playSound);
    $('#btnScaleUp').addEventListener('click', ()=>zoom(+0.05));
    $('#btnScaleDown').addEventListener('click', ()=>zoom(-0.05));
    $('#btnToggleHH').addEventListener('click', ()=> DB.toggleHH());

    // Accesibilidad b√°sica por teclado/botones HID
    window.addEventListener('keydown', (e)=>{
      if(e.key==='+'||e.key==='=') zoom(+0.05);
      if(e.key==='-'||e.key==='_') zoom(-0.05);
      if(e.key==='Enter') confirmOrder();
    });

    // iOS: evita zoom accidental en inputs
    $$('input,select').forEach(el=> el.addEventListener('focus', ()=> document.querySelector('meta[name=viewport]').setAttribute('content','width=device-width, initial-scale=1, maximum-scale=1') ));
  }

  document.addEventListener('DOMContentLoaded', init);
  </script>  <script>
    // Compat: fallback de arranque para iOS (apertura desde Archivos)
    (function(){
      function safeRender(){
        try{
          var list = document.getElementById('productList');
          if(list && !list.children.length && typeof renderProducts==='function'){
            renderProducts();
          }
        }catch(e){ /* noop */ }
      }
      // Bot√≥n manual para recargar men√∫
      var br = document.getElementById('btnReload');
      if(br){ br.addEventListener('click', function(){ safeRender(); toast('Men√∫ recargado'); }); }
      // Doble intento de inicializaci√≥n
      if (document.readyState !== 'loading') setTimeout(safeRender, 0);
      document.addEventListener('DOMContentLoaded', safeRender);
      setTimeout(safeRender, 400);
      // Mostrar errores en pantalla
      window.onerror = function(msg){ try{ toast('JS error: '+msg); }catch(_){} };
    })();
  </script></body>
</html>
